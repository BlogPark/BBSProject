@{
    ViewBag.Title = "Notices";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}
@model BBSProject.WebUI.Areas.Admin.Models.NoticeViewModel
@section Head{
    <link href="~/ueditor/themes/iframe.css" rel="stylesheet" />
    <script src="~/ueditor/ueditor.all.js"></script>
    <script src="~/ueditor/ueditor.all.min.js"></script>
    <script src="~/ueditor/ueditor.config.js"></script>
    <script type="text/javascript">
        var grid; var texteditor;
        $(function () {
            grid = $("#noticeslistgrid").ligerGrid({
                checkBox: false,
                height: '99%',
                allowUnSelectRow: false,
                columns: [
                    {
                        display: 'NoticeID', name: 'NoticeID', hide: true,
                        width: 100, editor: { type: 'text' }
                    },
                    {
                        display: '标  题', name: 'NoticeTitle',
                        width: 200, editor: { type: 'text' }
                    },
                    {
                        display: '发布时间', name: 'PublishTime', type: 'date', format: 'yyyy-MM-dd hh:mm:ss',
                        width: 200, editor: { type: 'text' }
                    },
                    {
                        display: '失效时间', name: 'ExpiredTime', type: 'date', format: 'yyyy-MM-dd hh:mm:ss',
                        width: 200, editor: { type: 'date' }
                    },
                    {
                        display: '发布状态', name: 'PublishStateName',
                        width: 100, editor: { type: 'text' }
                    },
                    {
                        display: '状  态', name: 'UsedName',
                        width: 100, editor: { type: 'text' }
                    },
                    {
                        display: '发布人', name: 'PublishUserName',
                        width: 100, editor: { type: 'text' }
                    },
                    {
                        display: 'PublishState', name: 'PublishState', hide: true,
                        width: 100, editor: { type: 'text' }
                    },
                    {
                        display: 'IsUsed', name: 'IsUsed', hide: true,
                        width: 100, editor: { type: 'text' }
                    }
                ],
                url: '/Admin/NoticeNews/getnoticeslist',
                rownumbers: true,
                pageSize: 200,
                pageSizeOptions: [200, 300, 400],
                enableEdit: false,
                detailToEdit: false,
                forzen: false,
                isScroll: true,
                dataAction: 'server',
                Width: '99%',
                onSelectRow: function (rowdata, rowindex) {
                    alert(rowdata.IsUsed);
                }
            });
            $("#pageloading").hide();
            texteditor = new baidu.editor.ui.Editor({
                UEDITOR_HOME_URL: '/ueditor/',//配置编辑器路径
                iframeCssUrl: '/ueditor/themes/iframe.css',//样式路径
                initialContent: '欢迎使用ueditor',//初始化编辑器内容
                autoHeightEnabled: true,//高度自动增长
                minFrameHeight: 500//最小高度
            });
            texteditor.render('noticecontent');
            $("#addsysuserbtn").click(function () {
                $.ligerDialog.open({
                    target: $("#addnoticepanel"),
                    width: 650,
                    height: 810,
                    title: '添加新账户',
                    buttons: [{}]
                });
            });
        });
    </script>
}

<table style="margin:0px;width:95%;height:95%;">
    <tbody>
        <tr style="height:20px;border:0px;">
            <td>
                系统公告管理
            </td>
        </tr>
        <tr style="height:100px;text-align:right;border:0px;">
            <td>
                @{
                    foreach (var item in Model.sysusermodular)
                    {
                        if (item.ModularName.Contains("发布"))
                        {
                            <input type="button" id="addsysuserbtn" value="发布公告" />
                        }
                        else if (item.ModularName.Contains("撤销"))
                        {
                            <input type="button" id="unablesysuserbtn" value="撤销公告" />
                        }
                        else if (item.ModularName.Contains("修改"))
                        {
                            <input type="button" id="updatesysuserbtn" value="修改公告" />
                        }
                    }
                }
            </td>
        </tr>
        <tr>
            <td>
                <div class="l-loading" style="display:block" id="pageloading"></div>
                <div class="l-clear"></div>
                <div id="noticeslistgrid"></div>
                <div style="display:none;">
                </div>
            </td>
        </tr>
    </tbody>
</table>

<div id="addnoticepanel" style="width:600px;height:800px;display:none">
    <table>
        <tr>
            <td>标 题<p style="color:red">*</p><input type="text" style="" /></td>
        </tr>
        <tr>
            <td>失效时间：<input type="datetime" /></td>
        </tr>
        <tr>
            <td><textarea id="noticecontent"></textarea></td>
        </tr>
    </table>
</div>